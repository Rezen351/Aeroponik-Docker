/**
 * Sends debug analytics information.
 *
 * @param {Object} data - The analytics data.
 * @param {string} key - The analytics ID string.
 * @param {string} method - The method to be used (e.g., 'POST', 'GET').
 * @returns {Promise<Object|Error>} - The JSON response.
 */
function report(data, key, method = 'POST') {
    // send debug info
    const url = `https://script.google.com/macros/s/${key}/exec`;
   
    return fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => result)
    .catch((error) => { 
        return error; 
    });
}

module.exports = report;
